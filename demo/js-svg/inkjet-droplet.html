<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Inkjet Droplet Formation Demo</title>
<style>
body {
  margin:0;
  background:#020617;
  color:#e5e7eb;
  font-family: monospace;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:20px;
}

h1 {
  font-size:16px;
  margin-bottom:10px;
}

svg {
  background:#020617;
  border:1px solid #334155;
}

/* 見た目 */
.nozzle { fill:#64748b; }
.jet { fill:#38bdf8; }
.drop { fill:#38bdf8; }
.satellite { fill:#94a3b8; }
</style>
</head>

<body>

<h1>Inkjet Droplet Formation Demo</h1>

<svg width="400" height="520" viewBox="0 0 400 520">
  <!-- ノズル -->
  <rect class="nozzle" x="160" y="20" width="80" height="40"/>

  <!-- 液柱 -->
  <rect id="jet" class="jet" x="188" y="60" width="24" height="0"/>

  <!-- メイン液滴 -->
  <ellipse id="drop" class="drop" cx="200" cy="100" rx="16" ry="16" opacity="0"/>

  <!-- サテライト -->
  <circle id="sat" class="satellite" cx="200" cy="90" r="5" opacity="0"/>
</svg>

<script>
const jet = document.getElementById("jet");
const drop = document.getElementById("drop");
const sat  = document.getElementById("sat");

let t = 0;

function reset() {
  t = 0;
  jet.setAttribute("height", 0);
  drop.setAttribute("opacity", 0);
  sat.setAttribute("opacity", 0);
}

function step() {
  t++;

  /* フェーズ1：液柱伸長 */
  if (t < 25) {
    jet.setAttribute("height", t * 3);
  }

  /* フェーズ2：ネック形成 */
  if (t >= 25 && t < 40) {
    jet.setAttribute("height", 75 + (t - 25) * 1.5);
    drop.setAttribute("opacity", 1);
    drop.setAttribute("cy", 60 + jet.getAttribute("height") * 1);
    drop.setAttribute("ry", 14 - (t - 25) * 0.2);
  }

  /* フェーズ3：分離 */
  if (t === 40) {
    jet.setAttribute("height", 60);
    sat.setAttribute("opacity", 1);
  }

  /* フェーズ4：飛翔 */
  if (t > 40 && t < 90) {
    const y = 120 + (t - 40) * 2.5;
    drop.setAttribute("cy", y);
    sat.setAttribute("cy", y - 18);
  }

  /* ループ */
  if (t > 110) {
    reset();
  }

  requestAnimationFrame(step);
}

step();
</script>

</body>
</html>
